{"ast":null,"code":"import _regeneratorRuntime from\"/home/matias/projects/web/full-stack-open/osa_3/puhelinluettelo/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/matias/projects/web/full-stack-open/osa_3/puhelinluettelo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/matias/projects/web/full-stack-open/osa_3/puhelinluettelo/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState,useEffect}from\"react\";import Filter from\"./components/Filter\";import Person from\"./components/Person\";import PersonForm from\"./components/PersonForm\";import personService from\"./services/persons\";import\"./app.css\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),newName=_useState4[0],setNewName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),number=_useState6[0],setNumber=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),addedMessage=_useState8[0],setAddedMessage=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),errorMessage=_useState10[0],setErrorMessage=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),httpStatusCode=_useState12[0],setHttpStatusCode=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),returnedPerson=_useState14[0],setReturnedPerson=_useState14[1];useEffect(function(){personService.getAll().then(function(returnedPersons){setPersons(returnedPersons);});},[]);var addName=function addName(event){event.preventDefault();var personObject={name:newName,number:number};var alreadyOnList=persons.find(function(o){return o.name===newName;});if(!alreadyOnList){// if (personObject.name.length > 2 && personObject.number > 7) {\n//     personService\n//         .create(personObject)\n//         .then((returnedPerson) => {\n//             setPersons(persons.concat(returnedPerson));\n//         })\n//         .catch((error) => {\n//             setHttpStatusCode(error);\n//         });\n//     setPersons(persons.concat(personObject));\n//     setAddedMessage(`${personObject.name} was added to numbers`);\n//     setTimeout(() => {\n//         setAddedMessage(null);\n//     }, 2000);\n//     setNewName(\"\");\n//     setNumber(\"\");\n// } else {\n//     setErrorMessage(\"error\");\n//     setTimeout(() => {\n//         setErrorMessage(null);\n//     }, 2000);\n// }\nvar createPerson=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var a;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:personService.create(personObject).then(function(returnedPerson){a=returnedPerson;}).catch(function(error){setHttpStatusCode(error);});console.log(a);return _context.abrupt(\"return\",a);case 3:case\"end\":return _context.stop();}}},_callee);}));return function createPerson(){return _ref.apply(this,arguments);};}();var addPerson=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var a;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return createPerson();case 2:a=_context2.sent;console.log(a);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function addPerson(){return _ref2.apply(this,arguments);};}();addPerson();// console.log(\"ret person\", returnedPerson);\n// console.log(\"http status\", httpStatusCode);\n// if (!httpStatusCode) {\n//     setPersons(persons.concat(returnedPerson));\n//     setAddedMessage(`${personObject.name} was added to numbers`);\n//     setTimeout(() => {\n//         setAddedMessage(null);\n//     }, 2000);\n//     setNewName(\"\");\n//     setNumber(\"\");\n// }\n}else{if(window.confirm(\"\".concat(personObject.name,\" is already on the list, replace the old number with a new one?\"))){updatePerson(alreadyOnList.id,personObject);setNewName(\"\");setNumber(\"\");}}};var handlePersonChange=function handlePersonChange(event){setNewName(event.target.value);};var handleNumberChange=function handleNumberChange(event){setNumber(event.target.value);};var handleFilter=function handleFilter(event){setPersons(filterPersons(persons,event.target.value));};var filterPersons=function filterPersons(persons,f){return persons.filter(function(person){return person.name.includes(f);});};var deletePerson=function deletePerson(person){if(window.confirm(\"delete \".concat(person.name,\"?\"))){personService.remove(person.id).then(function(){personService.getAll().then(function(returnedPersons){setPersons(returnedPersons);});});}return;};var updatePerson=function updatePerson(id,person){console.log(person);personService.update(id,person).then(function(returnedPerson){setPersons(persons.map(function(person){return person.id!==id?person:returnedPerson;}));});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),/*#__PURE__*/_jsx(Notification,{message:errorMessage,type:\"fail\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Search\"}),/*#__PURE__*/_jsx(Filter,{onChange:handleFilter}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:addName,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Add a new\"}),/*#__PURE__*/_jsx(PersonForm,{name:newName,number:number,personChange:handlePersonChange,numberChange:handleNumberChange})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"add\"})})]}),/*#__PURE__*/_jsx(Notification,{message:addedMessage,type:\"success\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Numbers\"}),/*#__PURE__*/_jsx(Person,{persons:persons,deletePerson:deletePerson})]});};var Notification=function Notification(_ref3){var message=_ref3.message,type=_ref3.type;if(message===null){return null;}if(type===\"fail\"){return/*#__PURE__*/_jsx(\"div\",{className:\"fail\",children:message});}else{return/*#__PURE__*/_jsx(\"div\",{className:\"success\",children:message});}};export default App;","map":{"version":3,"sources":["/home/matias/projects/web/full-stack-open/osa_3/puhelinluettelo/src/App.js"],"names":["React","useState","useEffect","Filter","Person","PersonForm","personService","App","persons","setPersons","newName","setNewName","number","setNumber","addedMessage","setAddedMessage","errorMessage","setErrorMessage","httpStatusCode","setHttpStatusCode","returnedPerson","setReturnedPerson","getAll","then","returnedPersons","addName","event","preventDefault","personObject","name","alreadyOnList","find","o","createPerson","create","a","catch","error","console","log","addPerson","window","confirm","updatePerson","id","handlePersonChange","target","value","handleNumberChange","handleFilter","filterPersons","f","filter","person","includes","deletePerson","remove","update","map","Notification","message","type"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Filter from \"./components/Filter\";\nimport Person from \"./components/Person\";\nimport PersonForm from \"./components/PersonForm\";\nimport personService from \"./services/persons\";\nimport \"./app.css\";\n\nconst App = () => {\n    const [persons, setPersons] = useState([]);\n    const [newName, setNewName] = useState(\"\");\n    const [number, setNumber] = useState(\"\");\n    const [addedMessage, setAddedMessage] = useState(null);\n    const [errorMessage, setErrorMessage] = useState(null);\n    const [httpStatusCode, setHttpStatusCode] = useState();\n    const [returnedPerson, setReturnedPerson] = useState();\n\n    useEffect(() => {\n        personService.getAll().then((returnedPersons) => {\n            setPersons(returnedPersons);\n        });\n    }, []);\n\n    const addName = (event) => {\n        event.preventDefault();\n        const personObject = {\n            name: newName,\n            number: number,\n        };\n\n        const alreadyOnList = persons.find((o) => o.name === newName);\n\n        if (!alreadyOnList) {\n            // if (personObject.name.length > 2 && personObject.number > 7) {\n            //     personService\n            //         .create(personObject)\n            //         .then((returnedPerson) => {\n            //             setPersons(persons.concat(returnedPerson));\n            //         })\n            //         .catch((error) => {\n            //             setHttpStatusCode(error);\n            //         });\n            //     setPersons(persons.concat(personObject));\n            //     setAddedMessage(`${personObject.name} was added to numbers`);\n            //     setTimeout(() => {\n            //         setAddedMessage(null);\n            //     }, 2000);\n            //     setNewName(\"\");\n            //     setNumber(\"\");\n            // } else {\n            //     setErrorMessage(\"error\");\n            //     setTimeout(() => {\n            //         setErrorMessage(null);\n            //     }, 2000);\n            // }\n\n            const createPerson = async () => {\n                let a;\n                personService\n                    .create(personObject)\n                    .then((returnedPerson) => {\n                        a = returnedPerson;\n                    })\n                    .catch((error) => {\n                        setHttpStatusCode(error);\n                    });\n\n                console.log(a);\n                return a;\n            };\n\n            const addPerson = async () => {\n                const a = await createPerson();\n                console.log(a);\n            };\n\n            addPerson();\n\n            // console.log(\"ret person\", returnedPerson);\n            // console.log(\"http status\", httpStatusCode);\n            // if (!httpStatusCode) {\n            //     setPersons(persons.concat(returnedPerson));\n            //     setAddedMessage(`${personObject.name} was added to numbers`);\n            //     setTimeout(() => {\n            //         setAddedMessage(null);\n            //     }, 2000);\n            //     setNewName(\"\");\n            //     setNumber(\"\");\n            // }\n        } else {\n            if (\n                window.confirm(\n                    `${personObject.name} is already on the list, replace the old number with a new one?`\n                )\n            ) {\n                updatePerson(alreadyOnList.id, personObject);\n                setNewName(\"\");\n                setNumber(\"\");\n            }\n        }\n    };\n\n    const handlePersonChange = (event) => {\n        setNewName(event.target.value);\n    };\n\n    const handleNumberChange = (event) => {\n        setNumber(event.target.value);\n    };\n\n    const handleFilter = (event) => {\n        setPersons(filterPersons(persons, event.target.value));\n    };\n\n    const filterPersons = (persons, f) => {\n        return persons.filter((person) => person.name.includes(f));\n    };\n\n    const deletePerson = (person) => {\n        if (window.confirm(`delete ${person.name}?`)) {\n            personService.remove(person.id).then(() => {\n                personService.getAll().then((returnedPersons) => {\n                    setPersons(returnedPersons);\n                });\n            });\n        }\n        return;\n    };\n\n    const updatePerson = (id, person) => {\n        console.log(person);\n        personService.update(id, person).then((returnedPerson) => {\n            setPersons(\n                persons.map((person) =>\n                    person.id !== id ? person : returnedPerson\n                )\n            );\n        });\n    };\n\n    return (\n        <div>\n            <h2>Phonebook</h2>\n            <Notification message={errorMessage} type=\"fail\" />\n            <h2>Search</h2>\n            <Filter onChange={handleFilter} />\n            <form onSubmit={addName}>\n                <div>\n                    <h2>Add a new</h2>\n                    <PersonForm\n                        name={newName}\n                        number={number}\n                        personChange={handlePersonChange}\n                        numberChange={handleNumberChange}\n                    />\n                </div>\n                <div>\n                    <button type=\"submit\">add</button>\n                </div>\n            </form>\n            <Notification message={addedMessage} type=\"success\" />\n            <h2>Numbers</h2>\n            <Person persons={persons} deletePerson={deletePerson} />\n        </div>\n    );\n};\n\nconst Notification = ({ message, type }) => {\n    if (message === null) {\n        return null;\n    }\n\n    if (type === \"fail\") {\n        return <div className=\"fail\">{message}</div>;\n    } else {\n        return <div className=\"success\">{message}</div>;\n    }\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}